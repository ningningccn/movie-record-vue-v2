import{r as h,g as B,o as V,a as c,c as v,b as t,F as A,d as O,n as R,t as S,e as Z,f as le,h as I,i as E,s as ae,w as P,j as W,k as Y,l as ne,m as re,p as oe,q as ie,u as b,v as k,x as H,y as D,z as q,A as ee,B as ce,C as ue,D as de,E as pe,G as te,S as K,H as ve,I as fe}from"./index-DvKwHlgR.js";import{L as he}from"./loading-CWnFMvcF.js";const ye={class:"sticky top-0 z-10 bg-second",id:"category-section"},ge={class:"container relative"},xe={class:"z-10 flex items-center justify-center pt-6"},_e={class:"relative"},me=["onClick"],be=t("div",{class:"border-b border-enable",id:"category-bar"},null,-1),Ce={__name:"type-tab",emits:["selected"],setup(a,{emit:n}){const y=n,i=h(0),o=h(0),r=h(""),u=(_,s)=>{r.value=_;const l=document.querySelector(`.btn-${s}`);i.value=l.clientWidth,o.value=l.offsetLeft,y("selected",_)},p=h([{title:"全部",slug:""},{title:"電影",slug:"movie"},{title:"電視劇",slug:"tv"},{title:"動漫",slug:"cartoon"}]);let e=B.timeline();const x=()=>{e.fromTo("#category-bar",{width:0,opacity:0},{duration:.5,opacity:1,width:"100%",onComplete:()=>{const _=document.querySelector(".btn-0");i.value=_.clientWidth}}),e.fromTo(".category-text",{opacity:0,y:10},{duration:.5,opacity:1,stagger:.1,y:0})};return V(()=>{x()}),(_,s)=>(c(),v("div",ye,[t("div",ge,[t("div",xe,[t("div",_e,[(c(!0),v(A,null,O(p.value,(l,f)=>(c(),v("button",{key:l.slug,class:R(["text-body-xl-medium category-text relative px-6 py-4 text-enable hover:text-white md:px-[60px]",[{"text-white":r.value==l.slug},`btn-${f}`]]),onClick:d=>u(l.slug,f)},S(l.title),11,me))),128)),t("div",{class:"absolute bottom-0 h-[3px] bg-primary transition-all duration-300",style:Z({width:`${i.value}px`,left:`${o.value}px`})},null,4)])])]),be]))}},se="--vc-auto-duration",Le=`height var(${se}) cubic-bezier(0.33, 1, 0.68, 1)`,N={padding:0},ke=300,we={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"},$e=()=>typeof navigator<"u"&&navigator.userAgent.includes("Firefox");function Q(a){return a.value?parseFloat(getComputedStyle(a.value).height):0}function U(a){var n;return{height:`${((n=a.value)==null?void 0:n.scrollHeight)||0}px`}}function J(a){if(!a.value)return{};const{transition:n}=getComputedStyle(a.value);return n==="all 0s ease 0s"||$e()&&n==="all"?{transition:Le}:{transition:n}}function X(a){if(!a.value)return!0;const{transition:n}=getComputedStyle(a.value);return typeof window.requestAnimationFrame>"u"||window.matchMedia("(prefers-reduced-motion: reduce)").matches||n.includes("none")||n.includes("height 0s")}function Se(a=0){if(a===0)return 0;const n=a/36,y=Math.round((4+15*n**.25+n/5)*10);return Number.isFinite(y)?y:0}const M=le({inheritAttrs:!0,__name:"Collapse",props:{when:{type:Boolean},baseHeight:{default:0},as:{default:"div"}},emits:["collapse","expand","collapsed","expanded"],setup(a,{emit:n}){const y=a,i=n,o=I(y,"when"),r=I(y,"baseHeight"),u=E(()=>({overflow:"hidden",height:`${r.value}px`})),p=E(()=>({...N,...r.value===0?{display:"none"}:u.value})),e=h(null),x=h(o.value?"expanded":"collapsed"),_=g=>x.value=g;function s(){return o.value?N:r.value===0?we:p.value}const l=ae(s()),f=g=>l.value=g,d=g=>f({...l.value,...g}),L=h(ke),w=g=>L.value=g,C=E(()=>({[se]:`${L.value}ms`}));function j(){f(N),_("expanded"),i("expanded")}function z(){f(p.value),_("collapsed"),i("collapsed")}V(()=>{if(!e.value)return;const g=Se(e.value.scrollHeight-r.value);g>0&&w(g),!o.value&&r.value===0&&f(p.value)}),P(o,g=>{if(e.value)if(g){if(X(e))return j();_("expanding"),i("expand"),f({...N,...u.value,...C.value}),requestAnimationFrame(()=>{if(e.value.scrollHeight===0)return j();d({...U(e),...J(e),willChange:"height"})})}else{if(X(e)||(_("collapsing"),i("collapse"),d({...C.value,...U(e)}),e.value.scrollHeight===0))return z();requestAnimationFrame(()=>{d({...u.value,...J(e),willChange:"height"})})}}),P(r,g=>{o.value||(g>0?d({display:void 0,height:`${g}px`}):d({display:"none"}))});function F(g){g.target&&g.target===e.value&&g.propertyName==="height"&&(o.value?Math.abs(e.value.scrollHeight-Q(e))<1&&j():Math.abs(r.value-Q(e))<1&&z())}return(g,m)=>(c(),W(ie(y.as),{ref_key:"collapseRef",ref:e,style:Z(l.value),onTransitionend:F,"data-collapse":x.value},{default:Y(()=>[ne(g.$slots,"default",re(oe({state:x.value})))]),_:3},40,["style","data-collapse"]))}}),Ae={class:"cursor-pointer rounded-[8px] bg-card"},Re=t("div",{class:"flex space-x-2"},[t("i",{class:"icon-sort text-[22px]"}),t("p",null,"排序")],-1),je={class:"flex flex-col space-y-6 p-6 pb-4"},Ee=["onClick"],Oe={key:0,class:"icon-check text-[20px]"},ze={__name:"sort",props:{currSlug:String},emits:["order"],setup(a,{emit:n}){const y=n,i=h(!1),o=[{title:"最新加入",slug:"desc"},{title:"最舊加入",slug:"asc"}],r=u=>{y("order",u)};return(u,p)=>(c(),v("div",Ae,[t("div",{class:"flex items-center justify-between px-6 py-2",onClick:p[0]||(p[0]=e=>i.value=!i.value)},[Re,t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":i.value}])},null,2)]),b(H(M),{when:i.value},{default:Y(()=>[t("div",je,[(c(),v(A,null,O(o,e=>t("button",{type:"button",class:"text-body-m-medium flex items-center justify-between text-left",key:e.slug,onClick:x=>r(e.slug)},[t("p",null,S(e.title),1),e.slug==a.currSlug?(c(),v("i",Oe)):k("",!0)],8,Ee)),64))])]),_:1},8,["when"])]))}},Ye={key:0,class:"absolute size-full rounded-[4px] bg-primary"},Fe=t("i",{class:"icon-check text-[20px] text-second"},null,-1),Te=[Fe],G={__name:"checkbox",props:{title:String,slug:String|Number,disabled:{type:Boolean,default:!1}},emits:["selected"],setup(a,{expose:n,emit:y}){const i=a,o=y,r=h(!1),u=()=>{i.disabled||(r.value=!r.value,o("selected",{slug:i.slug,status:r.value}))};return n({clearCheckbox:()=>{r.value=!1,o("selected","clear")}}),(e,x)=>(c(),v("div",{onClick:x[0]||(x[0]=_=>u()),class:R(["flex items-center space-x-2",[{"text-disable":a.disabled},{"cursor-pointer":!a.disabled}]])},[t("div",{class:R(["relative size-[20px] rounded-[4px]",[{border:!r.value},{"border-disable":a.disabled}]])},[r.value?(c(),v("div",Ye,Te)):k("",!0)],2),t("p",null,S(a.title),1)],2))}},Be=t("p",null,"狀態",-1),He={class:"flex flex-col space-y-3 pt-3"},De={__name:"status",props:{isAllExpanded:{type:Boolean}},emits:["currStatusLists"],setup(a,{expose:n,emit:y}){const i=y,o=[{title:"最愛",slug:"favorite"},{title:"已觀看",slug:"watched"},{title:"待觀看",slug:"to_be_watching"}],r=h(!0),u=D([]),p=h(),e=s=>!!(u.includes("watched")&&s=="to_be_watching"||u.includes("to_be_watching")&&s=="watched"),x=s=>{if(s=="clear")u.length=0;else{const l=u.indexOf(s.slug);l!==-1?u.splice(l,1):u.push(s.slug),i("currStatusLists",u)}};return n({clearAllCheckbox:()=>{p.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(c(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=f=>r.value=!r.value)},[Be,t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":r.value}])},null,2)]),b(H(M),{when:r.value},{default:Y(()=>[t("div",He,[(c(),v(A,null,O(o,(f,d)=>t("div",{key:d,class:""},[b(G,{title:f.title,slug:f.slug,disabled:e(f.slug),onSelected:x,ref_for:!0,ref_key:"statusRef",ref:p},null,8,["title","slug","disabled"])])),64))])]),_:1},8,["when"])]))}},Me={key:0},Ne={class:"flex flex-col space-y-3 pt-3"},Ve={__name:"year",props:{yearList:{type:Object}},emits:["currYearLists"],setup(a,{expose:n,emit:y}){const i=y,o=a,r=E(()=>o.yearList.map(s=>({title:s,slug:s}))),u=h(),p=h(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),i("currYearLists",e)}};return n({clearAllCheckbox:()=>{u.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(c(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=f=>p.value=!p.value)},[t("p",null,[q(" 年份 "),e.length>0?(c(),v("span",Me,"("+S(e.length)+")",1)):k("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":p.value}])},null,2)]),b(H(M),{when:p.value},{default:Y(()=>[t("div",Ne,[(c(!0),v(A,null,O(r.value,(f,d)=>(c(),v("div",{key:d,class:""},[b(G,{title:f.title,slug:f.slug,onSelected:x,ref_for:!0,ref_key:"yearRef",ref:u},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},qe={key:0},Ge={class:"flex flex-col space-y-3 pt-3"},Pe={__name:"category",props:{categoryList:{type:Object}},emits:["emitCurrCategory"],setup(a,{expose:n,emit:y}){const i=y,o=a,r=E(()=>o.categoryList.map(s=>({title:ee[s],slug:Number(s)}))),u=h(),p=h(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),i("emitCurrCategory",e)}};return n({clearAllCheckbox:()=>{u.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(c(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=f=>p.value=!p.value)},[t("p",null,[q(" 類別 "),e.length>0?(c(),v("span",qe,"("+S(e.length)+")",1)):k("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":p.value}])},null,2)]),b(H(M),{when:p.value},{default:Y(()=>[t("div",Ge,[(c(!0),v(A,null,O(r.value,(f,d)=>(c(),v("div",{key:d,class:""},[b(G,{title:f.title,slug:f.slug,onSelected:x,ref_for:!0,ref_key:"categoryRef",ref:u},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},We={key:0},Ie={class:"flex flex-col space-y-3 pt-3"},Ke={__name:"country",props:{countryList:{type:Object}},emits:["selectedLists"],setup(a,{expose:n,emit:y}){const i=y,o=a,r=E(()=>o.countryList.map(s=>({title:s,slug:s}))),u=h(),p=h(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),i("selectedLists",e)}};return n({clearAllCheckbox:()=>{u.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(c(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=f=>p.value=!p.value)},[t("p",null,[q(" 產地 "),e.length>0?(c(),v("span",We,"("+S(e.length)+")",1)):k("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":p.value}])},null,2)]),b(H(M),{when:p.value},{default:Y(()=>[t("div",Ie,[(c(!0),v(A,null,O(r.value,(f,d)=>(c(),v("div",{key:d,class:""},[b(G,{title:f.title,slug:f.slug,onSelected:x,ref_for:!0,ref_key:"countryRef",ref:u},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Qe={class:"rounded-[8px] bg-card"},Ue={class:"flex items-center justify-between px-6 py-2"},Je={class:"flex space-x-2"},Xe=t("i",{class:"icon-filter text-[22px]"},null,-1),Ze={class:"flex flex-col space-y-6 px-6 pb-4 pt-6"},et={__name:"index",emits:["currStatusLists","currCategoryLists","currYearLists","currCountryLists"],setup(a,{emit:n}){const y=n,i=h(!0),o=h([]),r=h([]),u=h([]),p=h([]),e=h([]),x=h([]),_=h([]),s=h(),l=h(),f=h(),d=h();(async()=>{const{yearOptLists:m,countryOtpLists:$,categoryOtpList:T}=await ce();o.value=m,r.value=$,u.value=T})();const w=m=>{p.value=m,y("currStatusLists",m)},C=m=>{const $=m.map(T=>({id:T,label:ee[T]}));_.value=$,y("currCategoryLists",$)},j=m=>{e.value=m,y("currYearLists",m)},z=m=>{x.value=m,y("currCountryLists",m)},F=()=>{s.value.clearAllCheckbox(),l.value.clearAllCheckbox(),f.value.clearAllCheckbox(),d.value.clearAllCheckbox()},g=E(()=>p.value.length>0||e.value.length>0||x.value.length>0||_.value.length>0);return(m,$)=>(c(),v("div",Qe,[t("div",Ue,[t("div",Je,[Xe,t("p",{class:"cursor-pointer",onClick:$[0]||($[0]=T=>i.value=!i.value)},"篩選")]),t("p",{class:R(["text-body-s",[g.value?"cursor-pointer text-primary hover:text-white":"text-disable"]]),onClick:$[1]||($[1]=T=>F())}," 清除 ",2)]),t("div",Ze,[b(De,{isAllExpanded:i.value,onCurrStatusLists:w,ref_key:"statusRef",ref:s},null,8,["isAllExpanded"]),b(Ve,{yearList:o.value,onCurrYearLists:j,ref_key:"yearRef",ref:l},null,8,["yearList"]),b(Pe,{categoryList:u.value,onEmitCurrCategory:C,ref_key:"categoryRef",ref:f},null,8,["categoryList"]),b(Ke,{countryList:r.value,onSelectedLists:z,ref_key:"countryRef",ref:d},null,8,["countryList"])])]))}},tt={class:"skeleton-card relative aspect-[3/4.3] overflow-hidden rounded-[8px]"},st={alt:"",class:"absolute aspect-[3/4.3] size-full cursor-pointer object-cover"},lt={class:"absolute left-0 top-0",id:"card-watched-wrap"},at={key:0,class:"text-body-s-medium rounded-[4px] bg-primary px-1 py-[2px] text-second"},nt={class:"mt-2 flex justify-between"},rt={class:"text-body-m-medium"},ot={key:0,class:"icon-heart-fill pt-1"},it={key:1,class:"icon-heart pt-1"},ct={class:"text-body-s-medium mt-1 flex justify-between text-enable"},ut={class:"flex flex-wrap gap-x-2"},dt={key:0,class:"flex items-center"},pt={key:0},vt={__name:"card",props:{data:{type:Object}},setup(a){const n=a;ue(),h(!1);const y=B.timeline(),i=()=>{y.fromTo("#card-watched-wrap",{x:-200},{x:0,delay:.5})},o=E(()=>{var r,u;return(u=(r=n==null?void 0:n.data)==null?void 0:r.movie)==null?void 0:u.year.slice(0,4)});return V(async()=>{await i()}),(r,u)=>{const p=de("RouterLink"),e=pe("lazy");return c(),W(p,{to:`/list/${n.data.id}`,class:"relative cursor-pointer overflow-hidden"},{default:Y(()=>{var x,_,s,l,f,d,L,w,C,j;return[t("div",tt,[te(t("img",st,null,512),[[e,(_=(x=a.data)==null?void 0:x.movie)==null?void 0:_.postImageUrl]])]),t("div",lt,[(l=(s=a.data)==null?void 0:s.movie)!=null&&l.watched?(c(),v("div",at," 已觀看 ")):k("",!0)]),t("div",null,[t("div",nt,[t("div",rt,S((d=(f=a.data)==null?void 0:f.movie)==null?void 0:d.name),1),(w=(L=a.data)==null?void 0:L.movie)!=null&&w.favorite?(c(),v("i",ot)):(c(),v("i",it))]),t("div",ct,[t("div",ut,[(c(!0),v(A,null,O((j=(C=a.data)==null?void 0:C.movie)==null?void 0:j.categoryList,(z,F)=>{var g,m;return c(),v("div",{key:z.slug},[F<3?(c(),v("div",dt,[q(S(z.label)+" ",1),((m=(g=a.data)==null?void 0:g.movie)==null?void 0:m.categoryList.length)>3&&F==2?(c(),v("span",pt,"...")):k("",!0)])):k("",!0)])}),128))]),t("div",null,S(o.value),1)])])]}),_:1},8,["to"])}}},ft={class:"container mb-20"},ht={class:"mt-20 flex md:space-x-5"},yt={class:"hidden min-w-[197px] max-w-[197px] md:block"},gt={class:"space-y-4"},xt={class:"w-full"},_t={class:"card-wrap grid grid-cols-4 gap-5 md:grid-cols-6 lg:grid-cols-6 xl:grid-cols-10",id:"card-wrap"},mt={key:0,class:"text-heading-s flex size-full items-center justify-center"},bt={key:0},kt={__name:"index",setup(a){B.registerPlugin(K);const n=h(!1),y=h(""),i=h([]),o=D({selectedStatusLists:[],selectedYearLists:[],selectedCountryLists:[],selectedCategoryLists:[],order:"desc"}),r=async(d,L)=>{n.value=!0,(await fe(d,L)).forEach(C=>{i.value.push({id:C.id,movie:C.data()})}),n.value=!1};r(y.value,o);const u=d=>{i.value=[],y.value=d,r(y.value,o)},p=d=>o.order=d,e=d=>o.selectedStatusLists=d,x=d=>o.selectedYearLists=d,_=d=>o.selectedCountryLists=d,s=d=>o.selectedCategoryLists=d;P(()=>o,(d,L)=>{i.value=[],r(y.value,o)},{deep:!0});const l=B.timeline(),f=()=>{l.fromTo(".an-sidebar",{display:"hidden",x:-100,opacity:0},{duration:.5,opacity:1,stagger:.2,delay:.5,x:0,display:"block"})};return B.registerPlugin(K),V(async()=>{await f()}),(d,L)=>(c(),v(A,null,[b(Ce,{onSelected:u}),t("div",ft,[t("main",ht,[t("div",yt,[t("div",gt,[b(ze,{currSlug:o.order,onOrder:p,class:"an-sidebar"},null,8,["currSlug"]),b(et,{class:"an-sidebar",onCurrStatusLists:e,onCurrYearLists:x,onCurrCountryLists:_,onCurrCategoryLists:s})])]),t("div",xt,[t("div",_t,[(c(!0),v(A,null,O(i.value,(w,C)=>(c(),W(vt,{data:w,class:"card col-span-2",key:C},null,8,["data"]))),128))]),i.value.length==0||n.value?(c(),v("div",mt,[te(b(he,null,null,512),[[ve,n.value]]),i.value.length==0&&!n.value?(c(),v("div",bt,"尚無資料")):k("",!0)])):k("",!0)])])])],64))}};export{kt as default};
