import{P as j,Q as P,r as n,w as q,a as u,c as v,G as b,R as L,b as e,T as N,n as D,_ as V,i as w,C as T,U as C,t as y,L as B,M as U,V as z,W as F,o as G,u as K,F as W,d as E,x as O,j as Q,X}from"./index-BmN6LUXy.js";const A={class:"flex items-center"},H=e("i",{class:"icon-search text-[48px]"},null,-1),J={class:"overflow-hidden"},Y=e("i",{class:"icon-close text-[32px]"},null,-1),Z=[Y],ee={__name:"search",props:{search:{},searchModifiers:{}},emits:j(["searchClick"],["update:search"]),setup(r,{emit:x}){const t=x,o=P(r,"search"),a=n(!1);q(()=>o.value,d=>{(d==null?void 0:d.length)>0?a.value=!0:a.value=!1});const i=()=>o.value="";return(d,l)=>(u(),v("div",A,[H,b(e("input",{type:"text",class:"text-body-xxl-medium ml-4 w-full bg-transparent text-white placeholder:text-enable focus:outline-none",placeholder:"輸入關鍵字","onUpdate:modelValue":l[0]||(l[0]=c=>o.value=c),onKeyup:l[1]||(l[1]=N(c=>t("searchClick"),["enter"]))},null,544),[[L,o.value]]),e("div",J,[e("button",{class:D(["mr-4 flex items-center transition-transform duration-300",[{"translate-x-10":!a.value}]]),onClick:l[2]||(l[2]=c=>i())},Z,2)]),e("button",{type:"button",onClick:l[3]||(l[3]=c=>t("searchClick")),class:"rounded-[8px] border px-4 py-2"}," Search ")]))}},I=r=>(B("data-v-956f36b9"),r=r(),U(),r),te={class:"overflow-hidden rounded-[8px]"},se={class:"skeleton-card aspect-[3/4.3] cursor-pointer object-cover"},ae=["src"],le=I(()=>e("div",{class:"absolute left-0 top-0"},null,-1)),oe={class:"mt-2 flex justify-between"},ne={class:"text-body-m-medium"},re=I(()=>e("i",{class:"icon-heart pt-1"},null,-1)),ce={class:"text-body-s-medium mt-1 flex justify-between text-enable"},ie={class:"flex space-x-2"},de={__name:"search-card",props:{id:{type:Number},title:{type:String,default:""},year:{type:String},poster:{type:String},date:{type:String},mediaType:{type:String}},emits:["getDataId"],setup(r,{emit:x}){const t=r,o=w(()=>t.poster?`https://image.tmdb.org/t/p/w500${t.poster}`:""),a=w(()=>t.mediaType=="tv"?"電視劇":"電影"),i=n(!1),d=T(),l=()=>{d.push({name:"searched",params:{mediaType:t.mediaType,mediaID:t.id}})},c=()=>{i.value=!0};return(p,h)=>(u(),v("div",{class:"relative rounded-[8px]",onClick:h[1]||(h[1]=g=>l())},[e("div",te,[b(e("div",se,null,512),[[C,!i.value]]),b(e("img",{src:o.value,alt:"",onLoad:h[0]||(h[0]=g=>c()),class:D(["aspect-[3/4.3] cursor-pointer object-cover opacity-0 transition-transform duration-500 hover:scale-110",{"opacity-100 transition-opacity duration-1000":i.value}])},null,42,ae),[[C,i.value]])]),le,e("div",null,[e("div",oe,[e("div",ne,y(r.title),1),re]),e("div",ce,[e("div",ie,y(a.value),1),e("div",null,y(r.date),1)])])]))}},ue=V(de,[["__scopeId","data-v-956f36b9"]]),pe={key:0,class:"flex-center h-full"},ve=e("p",{class:"text-body-xxl-medium flex items-center justify-center text-center text-enable"}," 暫未搜尋到任何結果 ",-1),he=[ve],_e={key:1,class:"text-body-l mt-[60px] font-medium"},fe={key:2,class:"mt-10 grid grid-cols-12 gap-5"},ye={__name:"search",setup(r){const x=T(),t=z(),o=n(""),a=n([]),i=n(1),d=n(0),l=n(0),c=n(!1),p=n({include_adult:"false",language:"zh-TW",query:"",page:1}),h=async()=>{p.value.query=o.value,p.value.page=1,x.push({query:{q:o.value}}),a.value=[]};q(()=>p.value,async(_,f)=>{const s=await X({params:p.value}),{page:m,results:k,total_pages:S,total_results:R}=s.data;i.value=m,m>1?a.value=[...a.value,...k]:a.value=k,d.value=S,l.value=R,m===S?c.value=!1:c.value=!0},{deep:!0});const g=n(null),$=n(null);n(!1),F($,([{isIntersecting:_}])=>{_&&p.value.page++},{pageViewRef:g});const M=()=>{};return G(async()=>{var _,f;p.value.query=(_=t==null?void 0:t.query)==null?void 0:_.q,o.value=(f=t==null?void 0:t.query)==null?void 0:f.q}),(_,f)=>(u(),v("div",{class:"container h-full pt-[60px]",ref_key:"pageViewRef",ref:g},[K(ee,{search:o.value,"onUpdate:search":f[0]||(f[0]=s=>o.value=s),onSearchClick:h},null,8,["search"]),a.value.length==0?(u(),v("div",pe,he)):(u(),v("div",_e," 結果顯示:1-"+y(a.value.length)+" (總共"+y(l.value)+"個) ",1)),a.value.length>0?(u(),v("div",fe,[(u(!0),v(W,null,E(a.value,(s,m)=>(u(),Q(ue,{key:m,id:s.id,title:(s==null?void 0:s.name)??s.title,poster:s.poster_path,date:(s==null?void 0:s.first_air_date)??s.release_date,mediaType:s.media_type,onGetDataId:M,class:"search-card col-span-6 sm:col-span-4 md:col-span-4 lg:col-span-3 xl:col-span-2"},null,8,["id","title","poster","date","mediaType"]))),128))])):O("",!0),e("div",{ref_key:"infiniteRef",ref:$},null,512)],512))}};export{ye as default};
