import{r as y,g as B,o as V,a as u,c as v,b as t,F as $,d as j,n as S,t as k,e as Z,f as se,h as I,i as R,s as le,w as P,j as W,k as Y,l as ae,m as re,p as ne,q as oe,u as b,v as H,x as E,y as D,z as q,A as ee,B as ie,_ as ce,C as ue,D as de,E as pe,G as ve,S as K,H as fe}from"./index-DphqHf3u.js";const ye={class:"sticky top-0 z-10 bg-second",id:"category-section"},he={class:"container relative"},xe={class:"z-10 flex items-center justify-center pt-6"},ge={class:"relative"},_e=["onClick"],me=t("div",{class:"border-b border-enable",id:"category-bar"},null,-1),be={__name:"category",emits:["selected"],setup(r,{emit:n}){const p=n,o=y(0),f=y(0),i=y(""),c=(_,s)=>{i.value=_;const a=document.querySelector(`.btn-${s}`);o.value=a.clientWidth,f.value=a.offsetLeft,p("selected",_)},d=y([{title:"全部",slug:""},{title:"電影",slug:"movie"},{title:"電視劇",slug:"tv"},{title:"綜藝",slug:"show"}]);let e=B.timeline();const x=()=>{e.fromTo("#category-bar",{width:0,opacity:0},{duration:.5,opacity:1,width:"100%",onComplete:()=>{const _=document.querySelector(".btn-0");o.value=_.clientWidth}}),e.fromTo(".category-text",{opacity:0,y:10},{duration:.5,opacity:1,stagger:.1,y:0})};return V(()=>{x()}),(_,s)=>(u(),v("div",ye,[t("div",he,[t("div",xe,[t("div",ge,[(u(!0),v($,null,j(d.value,(a,l)=>(u(),v("button",{key:a.slug,class:S(["text-body-xl-medium category-text relative px-6 py-4 text-enable hover:text-white md:px-[60px]",[{"text-white":i.value==a.slug},`btn-${l}`]]),onClick:g=>c(a.slug,l)},k(a.title),11,_e))),128)),t("div",{class:"absolute bottom-0 h-[3px] bg-primary transition-all duration-300",style:Z({width:`${o.value}px`,left:`${f.value}px`})},null,4)])])]),me]))}},te="--vc-auto-duration",Ce=`height var(${te}) cubic-bezier(0.33, 1, 0.68, 1)`,N={padding:0},Le=300,we={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"},ke=()=>typeof navigator<"u"&&navigator.userAgent.includes("Firefox");function Q(r){return r.value?parseFloat(getComputedStyle(r.value).height):0}function U(r){var n;return{height:`${((n=r.value)==null?void 0:n.scrollHeight)||0}px`}}function J(r){if(!r.value)return{};const{transition:n}=getComputedStyle(r.value);return n==="all 0s ease 0s"||ke()&&n==="all"?{transition:Ce}:{transition:n}}function X(r){if(!r.value)return!0;const{transition:n}=getComputedStyle(r.value);return typeof window.requestAnimationFrame>"u"||window.matchMedia("(prefers-reduced-motion: reduce)").matches||n.includes("none")||n.includes("height 0s")}function $e(r=0){if(r===0)return 0;const n=r/36,p=Math.round((4+15*n**.25+n/5)*10);return Number.isFinite(p)?p:0}const M=se({inheritAttrs:!0,__name:"Collapse",props:{when:{type:Boolean},baseHeight:{default:0},as:{default:"div"}},emits:["collapse","expand","collapsed","expanded"],setup(r,{emit:n}){const p=r,o=n,f=I(p,"when"),i=I(p,"baseHeight"),c=R(()=>({overflow:"hidden",height:`${i.value}px`})),d=R(()=>({...N,...i.value===0?{display:"none"}:c.value})),e=y(null),x=y(f.value?"expanded":"collapsed"),_=h=>x.value=h;function s(){return f.value?N:i.value===0?we:d.value}const a=le(s()),l=h=>a.value=h,g=h=>l({...a.value,...h}),L=y(Le),C=h=>L.value=h,O=R(()=>({[te]:`${L.value}ms`}));function A(){l(N),_("expanded"),o("expanded")}function z(){l(d.value),_("collapsed"),o("collapsed")}V(()=>{if(!e.value)return;const h=$e(e.value.scrollHeight-i.value);h>0&&C(h),!f.value&&i.value===0&&l(d.value)}),P(f,h=>{if(e.value)if(h){if(X(e))return A();_("expanding"),o("expand"),l({...N,...c.value,...O.value}),requestAnimationFrame(()=>{if(e.value.scrollHeight===0)return A();g({...U(e),...J(e),willChange:"height"})})}else{if(X(e)||(_("collapsing"),o("collapse"),g({...O.value,...U(e)}),e.value.scrollHeight===0))return z();requestAnimationFrame(()=>{g({...c.value,...J(e),willChange:"height"})})}}),P(i,h=>{f.value||(h>0?g({display:void 0,height:`${h}px`}):g({display:"none"}))});function F(h){h.target&&h.target===e.value&&h.propertyName==="height"&&(f.value?Math.abs(e.value.scrollHeight-Q(e))<1&&A():Math.abs(i.value-Q(e))<1&&z())}return(h,m)=>(u(),W(oe(p.as),{ref_key:"collapseRef",ref:e,style:Z(a.value),onTransitionend:F,"data-collapse":x.value},{default:Y(()=>[ae(h.$slots,"default",re(ne({state:x.value})))]),_:3},40,["style","data-collapse"]))}}),Se={class:"cursor-pointer rounded-[8px] bg-card"},Ae=t("div",{class:"flex space-x-2"},[t("i",{class:"icon-sort text-[22px]"}),t("p",null,"排序")],-1),Re={class:"flex flex-col space-y-6 p-6 pb-4"},Ee=["onClick"],je={__name:"sort",emits:["order"],setup(r,{emit:n}){const p=n,o=y(!1),f=[{title:"最新加入",slug:"desc"},{title:"最舊加入",slug:"asc"}],i=c=>{p("order",c)};return(c,d)=>(u(),v("div",Se,[t("div",{class:"flex items-center justify-between px-6 py-2",onClick:d[0]||(d[0]=e=>o.value=!o.value)},[Ae,t("i",{class:S(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":o.value}])},null,2)]),b(H(M),{when:o.value},{default:Y(()=>[t("div",Re,[(u(),v($,null,j(f,e=>t("button",{type:"button",class:"text-body-m-medium text-left",key:e.slug,onClick:x=>i(e.slug)},k(e.title),9,Ee)),64))])]),_:1},8,["when"])]))}},Oe={key:0,class:"absolute size-full rounded-[4px] bg-primary"},ze=t("i",{class:"icon-check text-[20px] text-second"},null,-1),Ye=[ze],G={__name:"checkbox",props:{title:String,slug:String|Number,disabled:{type:Boolean,default:!1}},emits:["selected"],setup(r,{expose:n,emit:p}){const o=r,f=p,i=y(!1),c=()=>{o.disabled||(i.value=!i.value,f("selected",{slug:o.slug,status:i.value}))};return n({clearCheckbox:()=>{i.value=!1,f("selected","clear")}}),(e,x)=>(u(),v("div",{onClick:x[0]||(x[0]=_=>c()),class:S(["flex items-center space-x-2",[{"text-disable":r.disabled},{"cursor-pointer":!r.disabled}]])},[t("div",{class:S(["relative size-[20px] rounded-[4px]",[{border:!i.value},{"border-disable":r.disabled}]])},[i.value?(u(),v("div",Oe,Ye)):E("",!0)],2),t("p",null,k(r.title),1)],2))}},Fe=t("p",null,"狀態",-1),Te={class:"flex flex-col space-y-3 pt-3"},Be={__name:"status",props:{isAllExpanded:{type:Boolean}},emits:["currStatusLists"],setup(r,{expose:n,emit:p}){const o=p,f=[{title:"最愛",slug:"favorite"},{title:"已觀看",slug:"watched"},{title:"待觀看",slug:"to_be_watching"}],i=y(!0),c=D([]),d=y(),e=s=>!!(c.includes("watched")&&s=="to_be_watching"||c.includes("to_be_watching")&&s=="watched"),x=s=>{if(s=="clear")c.length=0;else{const a=c.indexOf(s.slug);a!==-1?c.splice(a,1):c.push(s.slug),o("currStatusLists",c)}};return n({clearAllCheckbox:()=>{d.value.forEach(s=>{s.clearCheckbox()})}}),(s,a)=>(u(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:a[0]||(a[0]=l=>i.value=!i.value)},[Fe,t("i",{class:S(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":i.value}])},null,2)]),b(H(M),{when:i.value},{default:Y(()=>[t("div",Te,[(u(),v($,null,j(f,(l,g)=>t("div",{key:g,class:""},[b(G,{title:l.title,slug:l.slug,disabled:e(l.slug),onSelected:x,ref_for:!0,ref_key:"statusRef",ref:d},null,8,["title","slug","disabled"])])),64))])]),_:1},8,["when"])]))}},He={key:0},De={class:"flex flex-col space-y-3 pt-3"},Me={__name:"year",props:{yearList:{type:Object}},emits:["currYearLists"],setup(r,{expose:n,emit:p}){const o=p,f=r,i=R(()=>f.yearList.map(s=>({title:s,slug:s}))),c=y(),d=y(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const a=e.indexOf(s.slug);a!==-1?e.splice(a,1):e.push(s.slug),o("currYearLists",e)}};return n({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,a)=>(u(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:a[0]||(a[0]=l=>d.value=!d.value)},[t("p",null,[q(" 年份 "),e.length>0?(u(),v("span",He,"("+k(e.length)+")",1)):E("",!0)]),t("i",{class:S(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":d.value}])},null,2)]),b(H(M),{when:d.value},{default:Y(()=>[t("div",De,[(u(!0),v($,null,j(i.value,(l,g)=>(u(),v("div",{key:g,class:""},[b(G,{title:l.title,slug:l.slug,onSelected:x,ref_for:!0,ref_key:"yearRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Ne={key:0},Ve={class:"flex flex-col space-y-3 pt-3"},qe={__name:"category",props:{categoryList:{type:Object}},emits:["emitCurrCategory"],setup(r,{expose:n,emit:p}){const o=p,f=r,i=R(()=>f.categoryList.map(s=>({title:ee[s],slug:Number(s)}))),c=y(),d=y(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const a=e.indexOf(s.slug);a!==-1?e.splice(a,1):e.push(s.slug),o("emitCurrCategory",e)}};return n({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,a)=>(u(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:a[0]||(a[0]=l=>d.value=!d.value)},[t("p",null,[q(" 類別 "),e.length>0?(u(),v("span",Ne,"("+k(e.length)+")",1)):E("",!0)]),t("i",{class:S(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":d.value}])},null,2)]),b(H(M),{when:d.value},{default:Y(()=>[t("div",Ve,[(u(!0),v($,null,j(i.value,(l,g)=>(u(),v("div",{key:g,class:""},[b(G,{title:l.title,slug:l.slug,onSelected:x,ref_for:!0,ref_key:"categoryRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Ge={key:0},Pe={class:"flex flex-col space-y-3 pt-3"},We={__name:"country",props:{countryList:{type:Object}},emits:["selectedLists"],setup(r,{expose:n,emit:p}){const o=p,f=r,i=R(()=>f.countryList.map(s=>({title:s,slug:s}))),c=y(),d=y(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const a=e.indexOf(s.slug);a!==-1?e.splice(a,1):e.push(s.slug),o("selectedLists",e)}};return n({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,a)=>(u(),v("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:a[0]||(a[0]=l=>d.value=!d.value)},[t("p",null,[q(" 產地 "),e.length>0?(u(),v("span",Ge,"("+k(e.length)+")",1)):E("",!0)]),t("i",{class:S(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":d.value}])},null,2)]),b(H(M),{when:d.value},{default:Y(()=>[t("div",Pe,[(u(!0),v($,null,j(i.value,(l,g)=>(u(),v("div",{key:g,class:""},[b(G,{title:l.title,slug:l.slug,onSelected:x,ref_for:!0,ref_key:"countryRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Ie={class:"rounded-[8px] bg-card"},Ke={class:"flex items-center justify-between px-6 py-2"},Qe={class:"flex space-x-2"},Ue=t("i",{class:"icon-filter text-[22px]"},null,-1),Je={class:"flex flex-col space-y-6 px-6 pb-4 pt-6"},Xe={__name:"filter",emits:["currStatusLists","currCategoryLists","currYearLists","currCountryLists"],setup(r,{emit:n}){const p=n,o=y(!0),f=y([]),i=y([]),c=y([]),d=y([]),e=y([]),x=y([]),_=y([]),s=y(),a=y(),l=y(),g=y();(async()=>{const{yearOptLists:m,countryOtpLists:w,categoryOtpList:T}=await ie();f.value=m,i.value=w,c.value=T})();const C=m=>{d.value=m,p("currStatusLists",m)},O=m=>{const w=m.map(T=>({id:T,label:ee[T]}));_.value=w,p("currCategoryLists",w)},A=m=>{e.value=m,p("currYearLists",m)},z=m=>{x.value=m,p("currCountryLists",m)},F=()=>{s.value.clearAllCheckbox(),a.value.clearAllCheckbox(),l.value.clearAllCheckbox(),g.value.clearAllCheckbox()},h=R(()=>d.value.length>0||e.value.length>0||x.value.length>0||_.value.length>0);return(m,w)=>(u(),v("div",Ie,[t("div",Ke,[t("div",Qe,[Ue,t("p",{class:"cursor-pointer",onClick:w[0]||(w[0]=T=>o.value=!o.value)},"篩選")]),t("p",{class:S(["text-body-s",[h.value?"cursor-pointer text-primary hover:text-white":"text-disable"]]),onClick:w[1]||(w[1]=T=>F())}," 清除 ",2)]),t("div",Je,[b(Be,{isAllExpanded:o.value,onCurrStatusLists:C,ref_key:"statusRef",ref:s},null,8,["isAllExpanded"]),b(Me,{yearList:f.value,onCurrYearLists:A,ref_key:"yearRef",ref:a},null,8,["yearList"]),b(qe,{categoryList:c.value,onEmitCurrCategory:O,ref_key:"categoryRef",ref:l},null,8,["categoryList"]),b(We,{countryList:i.value,onSelectedLists:z,ref_key:"countryRef",ref:g},null,8,["countryList"])])]))}},Ze={class:"skeleton-card relative aspect-[3/4.3] overflow-hidden rounded-[8px]"},et={alt:"",class:"absolute aspect-[3/4.3] size-full cursor-pointer rounded-[8px] object-cover"},tt={class:"absolute left-0 top-0",id:"card-watched-wrap"},st={key:0,class:"text-body-s-medium rounded-[4px] bg-primary px-1 py-[2px] text-second"},lt={class:"mt-2 flex justify-between"},at={class:"text-body-m-medium"},rt={key:0,class:"icon-heart-fill pt-1"},nt={key:1,class:"icon-heart pt-1"},ot={class:"text-body-s-medium mt-1 flex justify-between text-enable"},it={class:"flex flex-wrap gap-x-2"},ct={key:0,class:"flex items-center"},ut={key:0},dt={__name:"card",props:{data:{type:Object}},setup(r){const n=r;ue();const p=B.timeline(),o=()=>{p.fromTo("#card-watched-wrap",{x:-200},{x:0,delay:.5})},f=R(()=>{var i,c;return(c=(i=n==null?void 0:n.data)==null?void 0:i.movie)==null?void 0:c.year.slice(0,4)});return V(async()=>{await o()}),(i,c)=>{const d=de("RouterLink"),e=pe("lazy");return u(),W(d,{to:`/list/${n.data.id}`,class:"relative cursor-pointer overflow-hidden"},{default:Y(()=>{var x,_,s,a,l,g,L,C,O,A;return[t("div",Ze,[ve(t("img",et,null,512),[[e,(_=(x=r.data)==null?void 0:x.movie)==null?void 0:_.postImageUrl]])]),t("div",tt,[(a=(s=r.data)==null?void 0:s.movie)!=null&&a.watched?(u(),v("div",st," 已觀看 ")):E("",!0)]),t("div",null,[t("div",lt,[t("div",at,k((g=(l=r.data)==null?void 0:l.movie)==null?void 0:g.name),1),(C=(L=r.data)==null?void 0:L.movie)!=null&&C.favorite?(u(),v("i",rt)):(u(),v("i",nt))]),t("div",ot,[t("div",it,[(u(!0),v($,null,j((A=(O=r.data)==null?void 0:O.movie)==null?void 0:A.categoryList,(z,F)=>{var h,m;return u(),v("div",{key:z.slug},[F<3?(u(),v("div",ct,[q(k(z.label)+" ",1),((m=(h=r.data)==null?void 0:h.movie)==null?void 0:m.categoryList.length)>3&&F==2?(u(),v("span",ut,"...")):E("",!0)])):E("",!0)])}),128))]),t("div",null,k(f.value),1)])])]}),_:1},8,["to"])}}},pt=ce(dt,[["__scopeId","data-v-647a3118"]]),vt={class:"container mb-20"},ft={class:"mt-20 flex md:space-x-5"},yt={class:"hidden min-w-[197px] max-w-[197px] md:block"},ht={class:"space-y-4"},xt={class:"w-full"},gt={class:"card-wrap grid grid-cols-4 gap-5 md:grid-cols-6 lg:grid-cols-6 xl:grid-cols-10",id:"card-wrap"},_t={key:0,class:"text-heading-s flex size-full items-center justify-center"},bt={__name:"index",setup(r){B.registerPlugin(K);const n=y(""),p=y([]),o=D({selectedStatusLists:[],selectedYearLists:[],selectedCountryLists:[],selectedCategoryLists:[],order:"desc"}),f=async(l,g)=>{(await fe(l,g)).forEach(C=>{p.value.push({id:C.id,movie:C.data()})})};f(n.value,o);const i=l=>{p.value=[],n.value=l,f(n.value,o)},c=l=>o.order=l,d=l=>o.selectedStatusLists=l,e=l=>o.selectedYearLists=l,x=l=>o.selectedCountryLists=l,_=l=>o.selectedCategoryLists=l;P(()=>o,(l,g)=>{p.value=[],f(n.value,o)},{deep:!0});const s=B.timeline(),a=()=>{s.fromTo(".an-sidebar",{display:"hidden",x:-100,opacity:0},{duration:.5,opacity:1,stagger:.2,delay:.5,x:0,display:"block"})};return B.registerPlugin(K),V(async()=>{await a()}),(l,g)=>(u(),v($,null,[b(be,{onSelected:i}),t("div",vt,[t("main",ft,[t("div",yt,[t("div",ht,[b(je,{onOrder:c,class:"an-sidebar"}),b(Xe,{class:"an-sidebar",onCurrStatusLists:d,onCurrYearLists:e,onCurrCountryLists:x,onCurrCategoryLists:_})])]),t("div",xt,[t("div",gt,[(u(!0),v($,null,j(p.value,(L,C)=>(u(),W(pt,{data:L,class:"card col-span-2",key:C},null,8,["data"]))),128))]),p.value.length==0?(u(),v("div",_t," 尚無資料 ")):E("",!0)])])])],64))}};export{bt as default};
