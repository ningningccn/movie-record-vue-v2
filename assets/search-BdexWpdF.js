import{V as N,W as P,r as o,w as T,o as q,a as i,c as u,G as x,X as V,b as t,Y as B,n as G,i as S,C as R,E as U,t as m,Z as W,I as E,g as F,L as K,x as C,J,z as D,F as O,d as X,j as Y,$ as Z}from"./index-Hpi7XxpT.js";import{L as A}from"./loading-BuulBnvn.js";const H={class:"flex items-center"},Q=t("i",{class:"icon-search text-[48px]"},null,-1),ee={class:"w-[45px] overflow-hidden"},te=t("i",{class:"icon-close text-[32px]"},null,-1),se=[te],ae={__name:"search-input",props:{search:{},searchModifiers:{}},emits:N(["searchClick"],["update:search"]),setup(v,{emit:g}){const s=g,n=P(v,"search"),r=o(!1),a=o(null);T(()=>n.value,d=>{(d==null?void 0:d.length)>0?r.value=!0:r.value=!1});const y=()=>n.value="";return q(()=>{a.value.focus()}),(d,l)=>(i(),u("div",H,[Q,x(t("input",{type:"text",class:"text-body-xxl-medium w-full bg-transparent text-white placeholder:text-enable focus:outline-none md:ml-4",placeholder:"輸入關鍵字","onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),ref_key:"searchInputRef",ref:a,onKeyup:l[1]||(l[1]=B(c=>s("searchClick"),["enter"]))},null,544),[[V,n.value]]),t("div",ee,[t("button",{type:"button",class:G(["flex items-center transition-transform duration-300",[{"translate-x-10":!r.value}]]),onClick:l[2]||(l[2]=c=>y())},se,2)]),t("button",{type:"button",onClick:l[3]||(l[3]=c=>s("searchClick")),class:"rounded-[8px] border px-4 py-2"}," Search ")]))}},le={class:"skeleton-card relative aspect-[3/4.3] overflow-hidden rounded-[8px]"},ne={alt:"",class:"absolute aspect-[3/4.3] size-full cursor-pointer object-cover"},oe={class:"mt-2 flex justify-between"},re={class:"text-body-m-medium"},ce=t("i",{class:"icon-heart pt-1"},null,-1),ie={class:"text-body-s-medium mt-1 flex justify-between text-enable"},ue={class:"flex space-x-2"},de={__name:"search-card",props:{id:{type:Number},title:{type:String,default:""},year:{type:String},poster:{type:String},date:{type:String},mediaType:{type:String}},emits:["getDataId"],setup(v,{emit:g}){const s=v,n=S(()=>s.poster?`https://image.tmdb.org/t/p/w500${s.poster}`:""),r=S(()=>s.mediaType=="tv"?"電視劇":"電影"),a=R(),y=()=>{a.push({name:"searched",params:{mediaType:s.mediaType,mediaID:s.id}})};return(d,l)=>{const c=U("lazy");return i(),u("div",{class:"relative overflow-hidden",onClick:l[0]||(l[0]=p=>y())},[t("div",le,[x(t("img",ne,null,512),[[c,n.value]])]),t("div",null,[t("div",oe,[t("div",re,m(v.title),1),ce]),t("div",ie,[t("div",ue,m(r.value),1),t("div",null,m(v.date),1)])])])}}},pe={key:0,class:"flex-center h-full"},ve={key:0,class:"text-body-xxl-medium flex items-center justify-center text-center text-enable",id:"no-result"},he={key:1,class:"text-body-l mt-[60px] font-medium"},fe={key:2,class:"mt-10 grid grid-cols-12 gap-5"},me={__name:"search",setup(v){const g=R(),s=W(),n=o(!1),r=o(""),a=o([]),y=o(1),d=o(0),l=o(0),c=o(!1),p=o({include_adult:"false",language:"zh-TW",query:"",page:1}),I=async()=>{p.value.query=r.value,p.value.page=1,g.push({query:{q:r.value}}),a.value=[]};T(()=>p.value,async(h,f)=>{n.value=!0;const e=await Z({params:p.value}),{page:_,results:w,total_pages:$,total_results:L}=e.data;y.value=_,_>1?a.value=[...a.value,...w]:a.value=w,d.value=$,l.value=L,n.value=!1,_===$?c.value=!1:c.value=!0},{deep:!0});const b=o(null),k=o(null);E(k,([{isIntersecting:h}])=>{h&&p.value.page++},{pageViewRef:b});const M=()=>{};let z=F.timeline();const j=async()=>{z.fromTo("#search-bar, #no-result",{opacity:0},{duration:1,delay:0,opacity:1,stagger:.2})};return q(async()=>{var h,f;p.value.query=(h=s==null?void 0:s.query)==null?void 0:h.q,r.value=(f=s==null?void 0:s.query)==null?void 0:f.q,await K(),await j()}),(h,f)=>(i(),u("div",{class:"container h-full pt-[60px]",ref_key:"pageViewRef",ref:b},[C(ae,{search:r.value,"onUpdate:search":f[0]||(f[0]=e=>r.value=e),onSearchClick:I,id:"search-bar"},null,8,["search"]),a.value.length==0||n.value?(i(),u("div",pe,[x(C(A,null,null,512),[[J,n.value]]),a.value.length==0&&!n.value?(i(),u("p",ve," 暫未搜尋到任何結果 ")):D("",!0)])):(i(),u("div",he," 結果顯示:1-"+m(a.value.length)+" (總共"+m(l.value)+"個) ",1)),a.value.length>0?(i(),u("div",fe,[(i(!0),u(O,null,X(a.value,(e,_)=>(i(),Y(de,{key:_,id:e.id,title:(e==null?void 0:e.name)??(e==null?void 0:e.original_title)??e.title,poster:e.poster_path,date:(e==null?void 0:e.first_air_date)??e.release_date,mediaType:e.media_type,onGetDataId:M,class:"search-card col-span-6 sm:col-span-4 md:col-span-4 lg:col-span-3 xl:col-span-2"},null,8,["id","title","poster","date","mediaType"]))),128))])):D("",!0),t("div",{ref_key:"infiniteRef",ref:k},null,512)],512))}};export{me as default};
