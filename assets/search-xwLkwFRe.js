import{Q as j,R as z,r as n,w as $,o as C,a as d,c as u,G as I,T as P,b as e,U as V,n as B,_ as U,i as w,C as T,E as G,t as m,M as W,N as E,V as F,W as K,g as L,I as O,u as Q,F as X,d as A,x as H,j as J,X as Y}from"./index-DphqHf3u.js";const Z={class:"flex items-center"},ee=e("i",{class:"icon-search text-[48px]"},null,-1),te={class:"overflow-hidden"},se=e("i",{class:"icon-close text-[32px]"},null,-1),ae=[se],le={__name:"search",props:{search:{},searchModifiers:{}},emits:j(["searchClick"],["update:search"]),setup(c,{emit:y}){const t=y,r=z(c,"search"),a=n(!1),p=n(null);$(()=>r.value,i=>{(i==null?void 0:i.length)>0?a.value=!0:a.value=!1});const _=()=>r.value="";return C(()=>{p.value.focus()}),(i,l)=>(d(),u("div",Z,[ee,I(e("input",{type:"text",class:"text-body-xxl-medium ml-4 w-full bg-transparent text-white placeholder:text-enable focus:outline-none",placeholder:"輸入關鍵字","onUpdate:modelValue":l[0]||(l[0]=o=>r.value=o),ref_key:"searchInputRef",ref:p,onKeyup:l[1]||(l[1]=V(o=>t("searchClick"),["enter"]))},null,544),[[P,r.value]]),e("div",te,[e("button",{class:B(["mr-4 flex items-center transition-transform duration-300",[{"translate-x-10":!a.value}]]),onClick:l[2]||(l[2]=o=>_())},ae,2)]),e("button",{type:"button",onClick:l[3]||(l[3]=o=>t("searchClick")),class:"rounded-[8px] border px-4 py-2"}," Search ")]))}},D=c=>(W("data-v-d10bf5a9"),c=c(),E(),c),oe={class:"skeleton-card relative aspect-[3/4.3] overflow-hidden rounded-[8px]"},ne={alt:"",class:"absolute aspect-[3/4.3] size-full cursor-pointer rounded-[8px] object-cover"},re=D(()=>e("div",{class:"absolute left-0 top-0"},null,-1)),ce={class:"mt-2 flex justify-between"},ie={class:"text-body-m-medium"},de=D(()=>e("i",{class:"icon-heart pt-1"},null,-1)),ue={class:"text-body-s-medium mt-1 flex justify-between text-enable"},pe={class:"flex space-x-2"},ve={__name:"search-card",props:{id:{type:Number},title:{type:String,default:""},year:{type:String},poster:{type:String},date:{type:String},mediaType:{type:String}},emits:["getDataId"],setup(c,{emit:y}){const t=c,r=w(()=>t.poster?`https://image.tmdb.org/t/p/w500${t.poster}`:""),a=w(()=>t.mediaType=="tv"?"電視劇":"電影");n(!1);const p=T(),_=()=>{p.push({name:"searched",params:{mediaType:t.mediaType,mediaID:t.id}})};return(i,l)=>{const o=G("lazy");return d(),u("div",{class:"relative overflow-hidden rounded-[8px]",onClick:l[0]||(l[0]=x=>_())},[e("div",oe,[I(e("img",ne,null,512),[[o,r.value]])]),re,e("div",null,[e("div",ce,[e("div",ie,m(c.title),1),de]),e("div",ue,[e("div",pe,m(a.value),1),e("div",null,m(c.date),1)])])])}}},he=U(ve,[["__scopeId","data-v-d10bf5a9"]]),_e={key:0,class:"flex-center h-full"},fe=e("p",{class:"text-body-xxl-medium flex items-center justify-center text-center text-enable",id:"no-result"}," 暫未搜尋到任何結果 ",-1),me=[fe],ye={key:1,class:"text-body-l mt-[60px] font-medium"},xe={key:2,class:"mt-10 grid grid-cols-12 gap-5"},be={__name:"search",setup(c){const y=T(),t=F(),r=n(""),a=n([]),p=n(1),_=n(0),i=n(0),l=n(!1),o=n({include_adult:"false",language:"zh-TW",query:"",page:1}),x=async()=>{o.value.query=r.value,o.value.page=1,y.push({query:{q:r.value}}),a.value=[]};$(()=>o.value,async(v,h)=>{const s=await Y({params:o.value}),{page:f,results:k,total_pages:S,total_results:N}=s.data;p.value=f,f>1?a.value=[...a.value,...k]:a.value=k,_.value=S,i.value=N,f===S?l.value=!1:l.value=!0},{deep:!0});const g=n(null),b=n(null);n(!1),K(b,([{isIntersecting:v}])=>{v&&o.value.page++},{pageViewRef:g});const R=()=>{};let q=L.timeline();const M=async()=>{q.fromTo("#search-bar, #no-result",{opacity:0},{duration:1,delay:0,opacity:1,stagger:.2})};return C(async()=>{var v,h;o.value.query=(v=t==null?void 0:t.query)==null?void 0:v.q,r.value=(h=t==null?void 0:t.query)==null?void 0:h.q,await O(),await M()}),(v,h)=>(d(),u("div",{class:"container h-full pt-[60px]",ref_key:"pageViewRef",ref:g},[Q(le,{search:r.value,"onUpdate:search":h[0]||(h[0]=s=>r.value=s),onSearchClick:x,id:"search-bar"},null,8,["search"]),a.value.length==0?(d(),u("div",_e,me)):(d(),u("div",ye," 結果顯示:1-"+m(a.value.length)+" (總共"+m(i.value)+"個) ",1)),a.value.length>0?(d(),u("div",xe,[(d(!0),u(X,null,A(a.value,(s,f)=>(d(),J(he,{key:f,id:s.id,title:(s==null?void 0:s.name)??s.title,poster:s.poster_path,date:(s==null?void 0:s.first_air_date)??s.release_date,mediaType:s.media_type,onGetDataId:R,class:"search-card col-span-6 sm:col-span-4 md:col-span-4 lg:col-span-3 xl:col-span-2"},null,8,["id","title","poster","date","mediaType"]))),128))])):H("",!0),e("div",{ref_key:"infiniteRef",ref:b},null,512)],512))}};export{be as default};
