import{r as f,g as B,o as V,a as d,c as h,b as t,F as A,d as O,n as R,t as $,e as Z,f as le,h as I,i as j,s as ae,w as P,j as W,k as Y,l as ne,m as re,p as oe,q as ie,u as b,v as H,x as S,y as D,z as q,A as ee,B as ce,C as ue,D as de,E as ve,G as te,S as K,H as pe,I as fe}from"./index-BNkpGbN3.js";import{L as he}from"./loading-C7xH0mjJ.js";const ye={class:"sticky top-0 z-10 bg-second",id:"category-section"},ge={class:"container relative"},xe={class:"z-10 flex items-center justify-center pt-6"},_e={class:"relative"},me=["onClick"],be=t("div",{class:"border-b border-enable",id:"category-bar"},null,-1),Ce={__name:"category",emits:["selected"],setup(r,{emit:a}){const y=a,o=f(0),i=f(0),n=f(""),c=(_,s)=>{n.value=_;const l=document.querySelector(`.btn-${s}`);o.value=l.clientWidth,i.value=l.offsetLeft,y("selected",_)},v=f([{title:"全部",slug:""},{title:"電影",slug:"movie"},{title:"電視劇",slug:"tv"},{title:"綜藝",slug:"show"}]);let e=B.timeline();const x=()=>{e.fromTo("#category-bar",{width:0,opacity:0},{duration:.5,opacity:1,width:"100%",onComplete:()=>{const _=document.querySelector(".btn-0");o.value=_.clientWidth}}),e.fromTo(".category-text",{opacity:0,y:10},{duration:.5,opacity:1,stagger:.1,y:0})};return V(()=>{x()}),(_,s)=>(d(),h("div",ye,[t("div",ge,[t("div",xe,[t("div",_e,[(d(!0),h(A,null,O(v.value,(l,p)=>(d(),h("button",{key:l.slug,class:R(["text-body-xl-medium category-text relative px-6 py-4 text-enable hover:text-white md:px-[60px]",[{"text-white":n.value==l.slug},`btn-${p}`]]),onClick:u=>c(l.slug,p)},$(l.title),11,me))),128)),t("div",{class:"absolute bottom-0 h-[3px] bg-primary transition-all duration-300",style:Z({width:`${o.value}px`,left:`${i.value}px`})},null,4)])])]),be]))}},se="--vc-auto-duration",Le=`height var(${se}) cubic-bezier(0.33, 1, 0.68, 1)`,N={padding:0},we=300,ke={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"},$e=()=>typeof navigator<"u"&&navigator.userAgent.includes("Firefox");function Q(r){return r.value?parseFloat(getComputedStyle(r.value).height):0}function U(r){var a;return{height:`${((a=r.value)==null?void 0:a.scrollHeight)||0}px`}}function J(r){if(!r.value)return{};const{transition:a}=getComputedStyle(r.value);return a==="all 0s ease 0s"||$e()&&a==="all"?{transition:Le}:{transition:a}}function X(r){if(!r.value)return!0;const{transition:a}=getComputedStyle(r.value);return typeof window.requestAnimationFrame>"u"||window.matchMedia("(prefers-reduced-motion: reduce)").matches||a.includes("none")||a.includes("height 0s")}function Se(r=0){if(r===0)return 0;const a=r/36,y=Math.round((4+15*a**.25+a/5)*10);return Number.isFinite(y)?y:0}const M=le({inheritAttrs:!0,__name:"Collapse",props:{when:{type:Boolean},baseHeight:{default:0},as:{default:"div"}},emits:["collapse","expand","collapsed","expanded"],setup(r,{emit:a}){const y=r,o=a,i=I(y,"when"),n=I(y,"baseHeight"),c=j(()=>({overflow:"hidden",height:`${n.value}px`})),v=j(()=>({...N,...n.value===0?{display:"none"}:c.value})),e=f(null),x=f(i.value?"expanded":"collapsed"),_=g=>x.value=g;function s(){return i.value?N:n.value===0?ke:v.value}const l=ae(s()),p=g=>l.value=g,u=g=>p({...l.value,...g}),L=f(we),w=g=>L.value=g,C=j(()=>({[se]:`${L.value}ms`}));function E(){p(N),_("expanded"),o("expanded")}function z(){p(v.value),_("collapsed"),o("collapsed")}V(()=>{if(!e.value)return;const g=Se(e.value.scrollHeight-n.value);g>0&&w(g),!i.value&&n.value===0&&p(v.value)}),P(i,g=>{if(e.value)if(g){if(X(e))return E();_("expanding"),o("expand"),p({...N,...c.value,...C.value}),requestAnimationFrame(()=>{if(e.value.scrollHeight===0)return E();u({...U(e),...J(e),willChange:"height"})})}else{if(X(e)||(_("collapsing"),o("collapse"),u({...C.value,...U(e)}),e.value.scrollHeight===0))return z();requestAnimationFrame(()=>{u({...c.value,...J(e),willChange:"height"})})}}),P(n,g=>{i.value||(g>0?u({display:void 0,height:`${g}px`}):u({display:"none"}))});function F(g){g.target&&g.target===e.value&&g.propertyName==="height"&&(i.value?Math.abs(e.value.scrollHeight-Q(e))<1&&E():Math.abs(n.value-Q(e))<1&&z())}return(g,m)=>(d(),W(ie(y.as),{ref_key:"collapseRef",ref:e,style:Z(l.value),onTransitionend:F,"data-collapse":x.value},{default:Y(()=>[ne(g.$slots,"default",re(oe({state:x.value})))]),_:3},40,["style","data-collapse"]))}}),Ae={class:"cursor-pointer rounded-[8px] bg-card"},Re=t("div",{class:"flex space-x-2"},[t("i",{class:"icon-sort text-[22px]"}),t("p",null,"排序")],-1),Ee={class:"flex flex-col space-y-6 p-6 pb-4"},je=["onClick"],Oe={__name:"sort",emits:["order"],setup(r,{emit:a}){const y=a,o=f(!1),i=[{title:"最新加入",slug:"desc"},{title:"最舊加入",slug:"asc"}],n=c=>{y("order",c)};return(c,v)=>(d(),h("div",Ae,[t("div",{class:"flex items-center justify-between px-6 py-2",onClick:v[0]||(v[0]=e=>o.value=!o.value)},[Re,t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":o.value}])},null,2)]),b(H(M),{when:o.value},{default:Y(()=>[t("div",Ee,[(d(),h(A,null,O(i,e=>t("button",{type:"button",class:"text-body-m-medium text-left",key:e.slug,onClick:x=>n(e.slug)},$(e.title),9,je)),64))])]),_:1},8,["when"])]))}},ze={key:0,class:"absolute size-full rounded-[4px] bg-primary"},Ye=t("i",{class:"icon-check text-[20px] text-second"},null,-1),Fe=[Ye],G={__name:"checkbox",props:{title:String,slug:String|Number,disabled:{type:Boolean,default:!1}},emits:["selected"],setup(r,{expose:a,emit:y}){const o=r,i=y,n=f(!1),c=()=>{o.disabled||(n.value=!n.value,i("selected",{slug:o.slug,status:n.value}))};return a({clearCheckbox:()=>{n.value=!1,i("selected","clear")}}),(e,x)=>(d(),h("div",{onClick:x[0]||(x[0]=_=>c()),class:R(["flex items-center space-x-2",[{"text-disable":r.disabled},{"cursor-pointer":!r.disabled}]])},[t("div",{class:R(["relative size-[20px] rounded-[4px]",[{border:!n.value},{"border-disable":r.disabled}]])},[n.value?(d(),h("div",ze,Fe)):S("",!0)],2),t("p",null,$(r.title),1)],2))}},Te=t("p",null,"狀態",-1),Be={class:"flex flex-col space-y-3 pt-3"},He={__name:"status",props:{isAllExpanded:{type:Boolean}},emits:["currStatusLists"],setup(r,{expose:a,emit:y}){const o=y,i=[{title:"最愛",slug:"favorite"},{title:"已觀看",slug:"watched"},{title:"待觀看",slug:"to_be_watching"}],n=f(!0),c=D([]),v=f(),e=s=>!!(c.includes("watched")&&s=="to_be_watching"||c.includes("to_be_watching")&&s=="watched"),x=s=>{if(s=="clear")c.length=0;else{const l=c.indexOf(s.slug);l!==-1?c.splice(l,1):c.push(s.slug),o("currStatusLists",c)}};return a({clearAllCheckbox:()=>{v.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(d(),h("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=p=>n.value=!n.value)},[Te,t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":n.value}])},null,2)]),b(H(M),{when:n.value},{default:Y(()=>[t("div",Be,[(d(),h(A,null,O(i,(p,u)=>t("div",{key:u,class:""},[b(G,{title:p.title,slug:p.slug,disabled:e(p.slug),onSelected:x,ref_for:!0,ref_key:"statusRef",ref:v},null,8,["title","slug","disabled"])])),64))])]),_:1},8,["when"])]))}},De={key:0},Me={class:"flex flex-col space-y-3 pt-3"},Ne={__name:"year",props:{yearList:{type:Object}},emits:["currYearLists"],setup(r,{expose:a,emit:y}){const o=y,i=r,n=j(()=>i.yearList.map(s=>({title:s,slug:s}))),c=f(),v=f(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),o("currYearLists",e)}};return a({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(d(),h("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=p=>v.value=!v.value)},[t("p",null,[q(" 年份 "),e.length>0?(d(),h("span",De,"("+$(e.length)+")",1)):S("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":v.value}])},null,2)]),b(H(M),{when:v.value},{default:Y(()=>[t("div",Me,[(d(!0),h(A,null,O(n.value,(p,u)=>(d(),h("div",{key:u,class:""},[b(G,{title:p.title,slug:p.slug,onSelected:x,ref_for:!0,ref_key:"yearRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Ve={key:0},qe={class:"flex flex-col space-y-3 pt-3"},Ge={__name:"category",props:{categoryList:{type:Object}},emits:["emitCurrCategory"],setup(r,{expose:a,emit:y}){const o=y,i=r,n=j(()=>i.categoryList.map(s=>({title:ee[s],slug:Number(s)}))),c=f(),v=f(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),o("emitCurrCategory",e)}};return a({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(d(),h("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=p=>v.value=!v.value)},[t("p",null,[q(" 類別 "),e.length>0?(d(),h("span",Ve,"("+$(e.length)+")",1)):S("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":v.value}])},null,2)]),b(H(M),{when:v.value},{default:Y(()=>[t("div",qe,[(d(!0),h(A,null,O(n.value,(p,u)=>(d(),h("div",{key:u,class:""},[b(G,{title:p.title,slug:p.slug,onSelected:x,ref_for:!0,ref_key:"categoryRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Pe={key:0},We={class:"flex flex-col space-y-3 pt-3"},Ie={__name:"country",props:{countryList:{type:Object}},emits:["selectedLists"],setup(r,{expose:a,emit:y}){const o=y,i=r,n=j(()=>i.countryList.map(s=>({title:s,slug:s}))),c=f(),v=f(!0),e=D([]),x=s=>{if(s=="clear")e.length=0;else{const l=e.indexOf(s.slug);l!==-1?e.splice(l,1):e.push(s.slug),o("selectedLists",e)}};return a({clearAllCheckbox:()=>{c.value.forEach(s=>{s.clearCheckbox()})}}),(s,l)=>(d(),h("div",null,[t("div",{class:"flex cursor-pointer items-center justify-between",onClick:l[0]||(l[0]=p=>v.value=!v.value)},[t("p",null,[q(" 產地 "),e.length>0?(d(),h("span",Pe,"("+$(e.length)+")",1)):S("",!0)]),t("i",{class:R(["icon-caret-down text-[20px] transition-transform duration-500",{"rotate-180":v.value}])},null,2)]),b(H(M),{when:v.value},{default:Y(()=>[t("div",We,[(d(!0),h(A,null,O(n.value,(p,u)=>(d(),h("div",{key:u,class:""},[b(G,{title:p.title,slug:p.slug,onSelected:x,ref_for:!0,ref_key:"countryRef",ref:c},null,8,["title","slug"])]))),128))])]),_:1},8,["when"])]))}},Ke={class:"rounded-[8px] bg-card"},Qe={class:"flex items-center justify-between px-6 py-2"},Ue={class:"flex space-x-2"},Je=t("i",{class:"icon-filter text-[22px]"},null,-1),Xe={class:"flex flex-col space-y-6 px-6 pb-4 pt-6"},Ze={__name:"filter",emits:["currStatusLists","currCategoryLists","currYearLists","currCountryLists"],setup(r,{emit:a}){const y=a,o=f(!0),i=f([]),n=f([]),c=f([]),v=f([]),e=f([]),x=f([]),_=f([]),s=f(),l=f(),p=f(),u=f();(async()=>{const{yearOptLists:m,countryOtpLists:k,categoryOtpList:T}=await ce();i.value=m,n.value=k,c.value=T})();const w=m=>{v.value=m,y("currStatusLists",m)},C=m=>{const k=m.map(T=>({id:T,label:ee[T]}));_.value=k,y("currCategoryLists",k)},E=m=>{e.value=m,y("currYearLists",m)},z=m=>{x.value=m,y("currCountryLists",m)},F=()=>{s.value.clearAllCheckbox(),l.value.clearAllCheckbox(),p.value.clearAllCheckbox(),u.value.clearAllCheckbox()},g=j(()=>v.value.length>0||e.value.length>0||x.value.length>0||_.value.length>0);return(m,k)=>(d(),h("div",Ke,[t("div",Qe,[t("div",Ue,[Je,t("p",{class:"cursor-pointer",onClick:k[0]||(k[0]=T=>o.value=!o.value)},"篩選")]),t("p",{class:R(["text-body-s",[g.value?"cursor-pointer text-primary hover:text-white":"text-disable"]]),onClick:k[1]||(k[1]=T=>F())}," 清除 ",2)]),t("div",Xe,[b(He,{isAllExpanded:o.value,onCurrStatusLists:w,ref_key:"statusRef",ref:s},null,8,["isAllExpanded"]),b(Ne,{yearList:i.value,onCurrYearLists:E,ref_key:"yearRef",ref:l},null,8,["yearList"]),b(Ge,{categoryList:c.value,onEmitCurrCategory:C,ref_key:"categoryRef",ref:p},null,8,["categoryList"]),b(Ie,{countryList:n.value,onSelectedLists:z,ref_key:"countryRef",ref:u},null,8,["countryList"])])]))}},et={class:"skeleton-card relative aspect-[3/4.3] overflow-hidden rounded-[8px]"},tt={alt:"",class:"absolute aspect-[3/4.3] size-full cursor-pointer object-cover"},st={class:"absolute left-0 top-0",id:"card-watched-wrap"},lt={key:0,class:"text-body-s-medium rounded-[4px] bg-primary px-1 py-[2px] text-second"},at={class:"mt-2 flex justify-between"},nt={class:"text-body-m-medium"},rt={key:0,class:"icon-heart-fill pt-1"},ot={key:1,class:"icon-heart pt-1"},it={class:"text-body-s-medium mt-1 flex justify-between text-enable"},ct={class:"flex flex-wrap gap-x-2"},ut={key:0,class:"flex items-center"},dt={key:0},vt={__name:"card",props:{data:{type:Object}},setup(r){const a=r;ue(),f(!1);const y=B.timeline(),o=()=>{y.fromTo("#card-watched-wrap",{x:-200},{x:0,delay:.5})},i=j(()=>{var n,c;return(c=(n=a==null?void 0:a.data)==null?void 0:n.movie)==null?void 0:c.year.slice(0,4)});return V(async()=>{await o()}),(n,c)=>{const v=de("RouterLink"),e=ve("lazy");return d(),W(v,{to:`/list/${a.data.id}`,class:"relative cursor-pointer overflow-hidden"},{default:Y(()=>{var x,_,s,l,p,u,L,w,C,E;return[t("div",et,[te(t("img",tt,null,512),[[e,(_=(x=r.data)==null?void 0:x.movie)==null?void 0:_.postImageUrl]])]),t("div",st,[(l=(s=r.data)==null?void 0:s.movie)!=null&&l.watched?(d(),h("div",lt," 已觀看 ")):S("",!0)]),t("div",null,[t("div",at,[t("div",nt,$((u=(p=r.data)==null?void 0:p.movie)==null?void 0:u.name),1),(w=(L=r.data)==null?void 0:L.movie)!=null&&w.favorite?(d(),h("i",rt)):(d(),h("i",ot))]),t("div",it,[t("div",ct,[(d(!0),h(A,null,O((E=(C=r.data)==null?void 0:C.movie)==null?void 0:E.categoryList,(z,F)=>{var g,m;return d(),h("div",{key:z.slug},[F<3?(d(),h("div",ut,[q($(z.label)+" ",1),((m=(g=r.data)==null?void 0:g.movie)==null?void 0:m.categoryList.length)>3&&F==2?(d(),h("span",dt,"...")):S("",!0)])):S("",!0)])}),128))]),t("div",null,$(i.value),1)])])]}),_:1},8,["to"])}}},pt={class:"container mb-20"},ft={class:"mt-20 flex md:space-x-5"},ht={class:"hidden min-w-[197px] max-w-[197px] md:block"},yt={class:"space-y-4"},gt={class:"w-full"},xt={class:"card-wrap grid grid-cols-4 gap-5 md:grid-cols-6 lg:grid-cols-6 xl:grid-cols-10",id:"card-wrap"},_t={key:0,class:"text-heading-s flex size-full items-center justify-center"},mt={key:0},Lt={__name:"index",setup(r){B.registerPlugin(K);const a=f(!1),y=f(""),o=f([]),i=D({selectedStatusLists:[],selectedYearLists:[],selectedCountryLists:[],selectedCategoryLists:[],order:"desc"}),n=async(u,L)=>{a.value=!0,(await fe(u,L)).forEach(C=>{o.value.push({id:C.id,movie:C.data()})}),a.value=!1};n(y.value,i);const c=u=>{o.value=[],y.value=u,n(y.value,i)},v=u=>i.order=u,e=u=>i.selectedStatusLists=u,x=u=>i.selectedYearLists=u,_=u=>i.selectedCountryLists=u,s=u=>i.selectedCategoryLists=u;P(()=>i,(u,L)=>{o.value=[],n(y.value,i)},{deep:!0});const l=B.timeline(),p=()=>{l.fromTo(".an-sidebar",{display:"hidden",x:-100,opacity:0},{duration:.5,opacity:1,stagger:.2,delay:.5,x:0,display:"block"})};return B.registerPlugin(K),V(async()=>{await p()}),(u,L)=>(d(),h(A,null,[b(Ce,{onSelected:c}),t("div",pt,[t("main",ft,[t("div",ht,[t("div",yt,[b(Oe,{onOrder:v,class:"an-sidebar"}),b(Ze,{class:"an-sidebar",onCurrStatusLists:e,onCurrYearLists:x,onCurrCountryLists:_,onCurrCategoryLists:s})])]),t("div",gt,[t("div",xt,[(d(!0),h(A,null,O(o.value,(w,C)=>(d(),W(vt,{data:w,class:"card col-span-2",key:C},null,8,["data"]))),128))]),o.value.length==0||a.value?(d(),h("div",_t,[te(b(he,null,null,512),[[pe,a.value]]),o.value.length==0&&!a.value?(d(),h("div",mt,"尚無資料")):S("",!0)])):S("",!0)])])])],64))}};export{Lt as default};
