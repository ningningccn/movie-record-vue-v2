# name: Build and Deploy # å¤§æ ‡é¢˜
# on:
#     push:
#         branches:
#             - main # ç›£è½å“ªå€‹åˆ†æ”¯çš„å“ªå€‹å‹•ä½œ
# permissions:
#     contents: write # è¨­å®šæ¬Šé™ï¼Œå¯å¯«ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨é…ç½®ï¼Œv4ç‰ˆæœ¬æ–°å¢çš„
# jobs:
#     build-and-deploy: # å…¶ä¸­ä¸€å€‹ä»»å‹™çš„åç¨±ï¼ŒID
#         runs-on: ubuntu-latest # è¿™ä¸ªä»»åŠ¡è¿è¡Œæ‰€éœ€çš„ç¯å¢ƒ
#         steps:
#             - name: Checkout main branch ğŸ›ï¸ # ç¬¬ä¸€æ­¥ï¼šè·å–æºç 
#               uses: actions/checkout@v3 # ä½¿ç”¨çš„å·¥å…·

#             - name: Install and Build ğŸ”§ # ç¬¬äºŒæ­¥ï¼šä¸‹è½½ä¾èµ–å’Œæ„å»º
#               run: |
#                   npm install
#                   npm build

#             - name: Deploy ğŸš€ # ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²
#               uses: JamesIves/github-pages-deploy-action@v4
#               with:
#                   folder: dist # éƒ¨ç½²çš„ç›®å½•
#                   branch: gh-pages # éƒ¨ç½²åˆ°å“ªä¸ªåˆ†æ”¯

# This is a basic workflow to help you get started with Actions
name: deploy

# Controls when the action will run.
on:
    # Triggers the workflow on push or pull request events but only for the main branch
    push:
        branches:
            - main
    # Allows you to run this workflow manually from the Actions tab

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
    # This workflow contains a single job called "build"
    build:
        # The type of runner that the job will run on
        runs-on: ubuntu-latest

        # Steps represent a sequence of tasks that will be executed as part of the job
        steps:
            # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
            - uses: actions/checkout@v3

            - name: Install & Build # åŸ·è¡ŒæŒ‡ä»¤
              run: |
                  npm install
                  npm run build

              env:
                  VITE_APP_API_KEY: ${{ secrets.VITE_APP_API_KEY }}
                  VITE_APP_APP_ID: ${{ secrets.VITE_APP_APP_ID }}
                  VITE_APP_AUTH_DOMAIN: ${{ secrets.VITE_APP_AUTH_DOMAIN }}
                  VITE_APP_MEASUREMENT_ID: ${{ secrets.VITE_APP_MEASUREMENT_ID }}
                  VITE_APP_MESSAGING_SENDER_ID: ${{ secrets.VITE_APP_MESSAGING_SENDER_ID }}
                  VITE_APP_PORJECT_ID: ${{ secrets.VITE_APP_PORJECT_ID }}
                  VITE_APP_STOREAGE_BUCKET: ${{ secrets.VITE_APP_STOREAGE_BUCKET }}
                  VITE_APP_THE_MOVIE_DB_API_KEY: ${{ secrets.VITE_APP_THE_MOVIE_DB_API_KEY }}
                  VITE_APP_THE_MOVIE_DB_BASE_URL: ${{ secrets.VITE_APP_THE_MOVIE_DB_BASE_URL }}

            # Runs a single command using the runners shell
            - name: Deploy
              uses: JamesIves/github-pages-deploy-action@releases/v4
              with:
                  # ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }} # Settings > Secret å»ºç«‹çš„ ACCESS_TOKENï¼Œæ¨åŒå€‹ repo çš„è©±å¯ä»¥ä¸éœ€è¦
                  BRANCH: gh-pages # deploy åˆ° gh-pages é€™å€‹åˆ†æ”¯
                  FOLDER: dist # build å¾Œçš„è³‡æ–™å¤¾
